----------------------------------------------------------------------
1.  Overview
----------------------------------------------------------------------

a.  Opencpn was built with the following objectives in mind.

    i.   Intended use as primary navigation interface for vessels
         with full-time helm-visible navigational suites.
         Other tools may be better for offline route planning, tide
         and current prediction, online logging, etc.
    ii.  Quick startup and shutdown.
    iii. Those and only those toolbar buttons really needed for
         daily operation.
    iv.  Portability, thus wxWidgets core components.  Currently
         tested and in production use on W98, XP, and Linux.
    v.   Conventional ( i.e. popular and modern ) chart format
         support.  In the real world, this means BSB format raster
         charts, and S57ENC format vector charts.



        And, of course, opencpn is all GPL'ed (or equivalent)
                        Open Source code.


    Personal Note:
    Opencpn is in primary daily use as the navigation package aboard
    M/V Dyad, a 48 ft trawler yacht cruising from Newfoundland to the
    Bahamas yearly.

----------------------------------------------------------------------
2.  Library Notes & Requirements
----------------------------------------------------------------------

a.  For S57 ENC support, OpenCPN requires the GDAL/OGR library,
Version 1.2.0 or better. This library is available from

         http://www.remotesensing.org/gdal

Note that there were problems with the ISO8211 library in Version 1.2.0
as relates to S57 ENC updates.  Specifically, OpenCPN requires
the inclusion in the library of ddfrecord.cpp Version 1.27 or greater
to support ENC updates.  Check the source version in your library:

    ident <library location>/libgdal.so | grep ddfrecord.cpp

OpenCPN will check for this library compatibility at run-time, display a
message, and disable ENC updates as necessary.

GDAL/OGR Version 1.2.1 corrects this bug
The current GDAL/OGR Version (1.3.2) (1 Aug, 2006) has been tested OK.

If GDAL/OGR library support is unavailable, there are two alternatives:

      i.  Build OpenCPN without S57-ENC support. See Build Notes below.
      ii. Build OpenCPN with internal OGR support.  This option is not
          recommended, as it will lead to conncurrency issues as GDAL/OGR is
          updated in the future.  But, if you must, the necessary sources are
          included in the OpenCPN distribution, and may be build enabled.




b.  iso8211 class support is required to build OpenCPN from source with
S57 ENC support. GDAL/OGR includes and uses iso8211 file support, but the
interesting classes and methods are not exported from the GDAL library.
So, the relevant files are in the source tree as src/myiso8211. These
files are verbatim copies of the files by the same name in GDAL/OGR library
Version 1.2.1.

Thanks to Frank Warmerdam and others for GDAL/OGR.
What an impressive body of work!

c.  OpenCPN S57 ENC support works best with access to the OpenGL Utility
library glu.  glu is used to tesselate large polygon areas into small
triangles for faster display rendering.  If you cannot use, or do not have
the OpenGL Utility library, you may choose to build OpenCPN with internal
tesselator support.  The internal tesselator is sub-optimal compared to glu,
but it does work fairly well, if slower slower. glu is better.
See the Build Notes section for applicable tesselator configuration options.


d.  WxWidgets########################################################

----------------------------------------------------------------------
3.  Platform Specific Build Notes
----------------------------------------------------------------------

a.  MS Windows
Set the required build options in nmake.opt.  See the comments within.

Then do:
            nmake -f makefile.vc clean
            nmake -f makefile.vc

The opencpn.exe file will be built in the .\release_ directory.

For a debug build, do:
            nmake -f makefile.vc CFG="debug" clean
            nmake -f makefile.vc CFG="debug"
The debug opencpn.exe file will be built in the .\debug_ directory.


In either case, do:
            nmake -f makefile.vc install

This will copy the appropriate files to the install location specified in
nmake.opt.



As a consequence of building with static GDAL/OGR library linkage,
the MS linker will emit a .LIB and .EXP file set, and complain
about library conflicts with LIBC.  These warnings come about
as a result of exports defined in gdal.lib. as a part of the default
gdalxx.dll build. These files and warnings may be safely ignored.


IMPORTANT:  Linking with GDAL/OGR as a DLL (e.g.. gdal12.dll) does not work.
OGR requires parameter passage via environment variables.  The library
uses getenv() to fetch parameter values.  getenv() does not work from within
a DLL, since a DLL has no common data storage with the caller.
See MS Knowledge Base Article ID: Q78542 .

There are two workarounds.
i.  Link GDAL/OGR statically or internally (i.e. do not use gdalxx.dll), or
ii. Ensure that the following two files are present in the user's
    current directory at run-time:
                  s57attributes.csv
                  s57objectclasses.csv

The nmake install target places these files in the selected install directory
automatically, typically C:\Program Files\opencpn

Finally, S57ENC support, and related GDAL/OGR compilation and linkage
may be disabled completely in nmake.opt by un-defining the variable USE_S57.

b. LINUX

Opencpn uses the GNU Automake system, so...

        ./configure
        make

        su, password

        make install

The GNU installer installs opencpn executable to /usr/local/bin, and
the required data files to /usr/local/share/opencpn.


Some configure options specific to opencpn are available:

        --enable-s57enc             Compile and enable S57ENC support
        --enable-s57enc=0           ...or not...
                                    Default is ENABLED.

        --with-gdal-internal        Use internal GDAL/OGR source.
                                    Useful in cases where GDAL library
                                    is not available.  As expected, the
                                    executable file size grows.
                                    Default is OFF.

        --with-tess-internal        Use internal tesselator, as opposed
                                    to OpenGL gluTess.
                                    Default is OFF.

        --with-wifi-client           Use (undocumented) wifi monitor client
                                    interface.
                                    Default is OFF.

GDAL/OGR and WxWidgets linkages and include paths are discovered by the
makefile using conventional gdal-config and wx-config scripts as
normally installed by those packages.

----------------------------------------------------------------------
4.  File and Directory Permissions under Linux
----------------------------------------------------------------------

a.  The directory tree containing the ENC vector charts must be
read and write enabled for the current user.  This allows the dynamic
creation of SENC files and chart thumbnail images as needed.

Since this tree, e.g. /usr/local/share/opencpn/ENC_ROOT, is typically
owned by root, it must be given (recursively) 0777 permissions.

b.  It is sufficient for all other directories in /usr/share/opencpn
to have permissions 0755, i.e. exec/searchable and readable by all.

----------------------------------------------------------------------
5. Support File Locations
----------------------------------------------------------------------

a.  Opencpn requires numerous auxiliary data files.  These files
are installed by the installer into the following locations:

      Linux   - /usr/local/share/opencpn/
      Windows - \Program Files\opencpn\

The following directories exist within the above:
         .../bitmaps                     - self evident
         .../tcdata                      - tide and current location data
         .../s57data                     - data files for S57ENC support
         .../wvsdata                     - World Vector Shoreline data

b.  Opencpn config files are expected in the following locations:

      Linux   - ~/.opencpn/opencpn.conf
      Windows - \Program Files\opencpn\opencpn.ini

The installer will place nice default files for your use.  The first
execution of opencpn will update as needed.  If for some reason the
config file is not found, opencpn will offer to create a useable
starting configuration.


----------------------------------------------------------------------
6. Serial Port GPS Data Input and Autopilot Output
----------------------------------------------------------------------

a.  LINUX
Opencpn runs at user privilege.  This means that in order to
read GPS input data and/or write autopilot output data, the serial
devices to be used must exhibit read and write permission for the
user in question.  For linux, these devices are created at startup.
Typically, the devices as created are owned by root, with additional
specific group (e.g. "uucp") r/w access,  i.e. permissions are 0660.

This configuration WILL NOT WORK for OpenCPN unless the user happens
to belong to the group under which the devices were created,
typically "uucp".  Not likely...

For the more general case, you must ensure that device permissions
will enable opencpn to read and write serial devices without root
privileges.  There are several ways to do this.

On a Linux with udev, check the files in /etc/udev/rules.d to
ensure that /dev/tty* devices are all created with the same group
and with 0666 permissions.  More generally, you may need to run mknod
or MAKEDEV as root to create a properly permissioned serial device before
executing opencpn.  For example:

      linux# mknod -m 666 /dev/ttyS0 c 4 64

If you use USB serial port adapters and your system has the Linux
hotplug facility installed, Todo............

Test your GPS input.  At user privilege,

      linux$ stty -F /dev/ttyXXX ispeed 4800
      linux$ cat </dev/ttyXXX

replace ttyXXX with the filename of the port.  This will probably be
either /dev/ttyUSB0 or /dev/ttyS0.  When you run this command, you
should see text lines beginning with $ come to stdout (possibly after
a short initial burst of binary garbage).  If you don't see this, you
may have OS-level problems with your serial support, but more likely
have the wrong device or permissions.  Look again.

b.  Windows
